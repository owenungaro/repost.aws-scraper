Hi,


We are trying to setup a 
SCP
  which will deny some 
DynamoDB
 actions based on the **IP Ranes ** of our Network, the way that IAM Users for example can't Scan or Query a DynamoDB table outside of our Network.


In this SCP we need to add a
n exception
 to some AWS Services (Like: 
EC2
 or 
Lambda
) which can freely Query/Scan a DynamoDB table if they have the necessary permissions.


We tried with the following SCP and it worked fine for the first case "IAM Users" but failed for the Lambda case as we still recieving an AccessDenied Error trying to Query a DynamoDB table from a Lambda Function :






Do you know how we can manage to add this exception for all AWS Services which need to perform any DynamoDB action without the need to use the ARN of specific IAM Role used by these service ?