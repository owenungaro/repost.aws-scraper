I'm trying to create a policy that will allow an EC2 instance access to a s3 bucket and prefix controlled via the Name tag on the EC2 instance. It feels like I should be able to create a policy similar to the below, but it isn't working. I get a 'PutObject operation: Access Denied' when I try and create an object.


My EC2 instance has a non-blank Name tag. If the ${aws:RequestTag/Name} portion from the Resource list, the EC2 instance can put files, but with the variable, the action fails. I'm trying to limit the s3 object prefix to include the value of the EC2 instance tag name


The policy I'm trying to use is:





From my ec2 instance I've executing the following, where the instance has Name=inst_name defined in the AWS control panel:


aws s3 cp my_file s3://my-backups-sn/inst_name/my_file.txt



Any guidance is gratefully accepted