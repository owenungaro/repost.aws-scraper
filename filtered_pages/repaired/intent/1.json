In the CDK code, I created a 
custom KMSKey
, and then configured the Image Recipe of EC2 Image Builder to use the KMSKey as the encryption key of EBS, after successfully creating the AMI, I used the AMI to launch the instance, and the consistent message failed to start, the error is as follows:

 Client.InvalidKMSKey.InvalidState: The KMS key provided is in an incorrect state
.


KMSKey's state is 
enabled
, otherwise the AMI would not be successfully generated, so I don't understand why the state Incorrect is still prompted.


I looked up the answer on the Internet and saw a post saying that it was a permission issue, and then I associated a role with an EC2 instance with an inline policy like this::





But the startup failed with the same error.


Does anyone know why?