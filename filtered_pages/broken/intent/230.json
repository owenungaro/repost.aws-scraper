So we deployed our secrets manager with user and passoword in one account and a resource policy with following statement:



And after resource creation i see a couple of seconds later an event in CloudTrail, generated by Username {mskAccId}, sourceIp kafka.amazonaws.com, overriding my policy with the following(no AWS principal and no "secretsmanager:DescribeSecret" ):


{
"Version" : "2012-10-17",
"Statement" : [ {
"Sid" : "AWSKafkaResourcePolicy",
"Effect" : "Allow",
"Principal" : {
"Service" : "kafka.amazonaws.com"
},
"Action" : [ "secretsmanager:getSecretValue" ],
"Resource" : "arn:aws:secretsmanager:eu-central-1:{mskAccId}:secret:AmazonMSK_eos-datapipeline-ads-all-prod-12345"
} ]
}


Any idea why?


I ll leave more info from the event in case u consider them relevant:


eventType": "AwsApiCall",
"sourceIPAddress": "kafka.amazonaws.com",
"userAgent": "kafka.amazonaws.com",
"eventCategory": "Management"