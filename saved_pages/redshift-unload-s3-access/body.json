{
  "body": "When I run the UNLOAD command in Amazon Redshift, I receive errors.\n\nShort description\nWhen you run\nUNLOAD\ncommands in Amazon Redshift, errors can occur for the following reasons:\nThe target Amazon Simple Storage Service (Amazon S3) bucket or prefix contains existing objects.\nYou didn't attach the AWS Identity and Access Management (IAM) role to your Amazon Redshift cluster.\nThe IAM role doesn't have the required S3 bucket permissions.\nThe database user doesn't have the necessary table or schema permissions.\nResolution\nNote:\nIf you receive errors when you run AWS Command Line Interface (AWS CLI) commands, then see\nTroubleshooting errors for the AWS CLI\n. Also, make sure that\nyou're using the most recent AWS CLI version\n.\nObjects exist in the S3 bucket or prefix\nIf objects already exist in the target S3 bucket or prefix, then you might get the following error message:\n\"Specified unload destination on S3 is not empty. Consider using a different bucket / prefix, manually removing the target files in S3, or using the ALLOWOVERWRITE option.\"\nTo resolve the error, run the following\nUNLOAD\ncommand with the\nALLOWOVERWRITE\nparameter:\nUNLOAD ('<SELECT query>')\nTO 's3://S3 bucket or prefix'\nIAM_ROLE 'IAM Role'\nALLOWOVERWRITE;\nNote:\nReplace\nS3 bucket\nor\nprefix\nwith your S3 bucket or prefix and\nIAM Role\nwith your IAM role.\nFor more information, see\nParameters\n.\nYou didn't associate the IAM role with the cluster\nIf you didn't associate the IAM role that's specified in the\nUNLOAD\ncommand with the Amazon Redshift cluster, then you get the following error message:\n\"UnauthorizedException, error type : 138, message: The requested role is not associated to cluster\".\nTo resolve the issue, associate the IAM role with the Amazon Redshift cluster.\nComplete the following steps:\nOpen the\nAmazon Redshift console\nor the AWS CLI.\nRun one of the following commands:\nFor Amazon Redshift Provisioned run the\nmodify-cluster-iam-roles\nAWS CLI command:\n## Redshift Provisioned\naws redshift modify-cluster-iam-roles \\\n    --cluster-identifier \"Cluster Name\" \\\n    --add-iam-roles \"IAM Role ARN\"\nNote:\nReplace\nCluster Name\nwith your cluster's name and\nIAM Role ARN\nwith your IAM role's Amazon Resource Name (ARN).\nFor Amazon Redshift Serverless, run the\nupdate-namespace\nAWS CLI command:\n## Redshift Serverless\naws redshift-serverless update-namespace \\\n    --namespace-name Namespace Name \\\n    --iam-roles \"IAM Role ARN\"\nNote:\nReplace\nNamespace Name\nwith your namespace's name and\nIAM Role ARN\nwith your IAM role's ARN.\nFor more information, see\nManaging IAM role association with a cluster\n.\nThe IAM role doesn't have the required S3 permissions\nIf the IAM role doesn't have the necessary S3 permissions, then the\nUNLOAD\ncommand fails and you get the following error message:\n\"S3ServiceException:User: arn:aws:sts::\n<Account ID>\n:assumed-role/\n<IAM Role Name>\n/RedshiftIamRoleSession is not authorized to perform: s3:PutObject on resource: \"\n<S3 Object Path>\n\" because no identity-based policy\".\nCheck that your IAM role has the required\nIAM permissions\nto successfully unload data to the target S3 bucket.\nThe database user doesn't have the necessary table or schema permissions\nIf the database user doesn't have the necessary permissions on the table or schema, then the user might get one of the following error messages:\n\"ERROR: permission denied for schema\n<Schema Name>\n\".\n\"ERROR: permission denied for relation\n<Table Name>\n\".\nTo grant the database user\nUSAGE\npermission on the schema and\nSELECT\npermission on the table, run one of the following\nGRANT\ncommands:\nGRANT USAGE ON SCHEMA Schema Name TO DB User Name;\nGRANT SELECT ON TABLE Table Name TO DB User Name;\nNote:\nIn the preceding commands, replace\nSchema Name\nwith your schema's name,\nTable name\nwith your table's name, and\nUser Name\nwith the user's username.\nAdditional troubleshooting\nTo identify the query ID and the error messages, see\nSTL_QUERY\nor\nSYS_QUERY_HISTORY\n.\nFor more information, see\nSTL_ERROR\nor\nSYS_UNLOAD_HISTORY\n."
}